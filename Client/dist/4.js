(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{745:function(e,t,n){e.exports=n.p+"8c9a57076747ac575f1511a49b61956b.png"},761:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),r=n(6),i=n.n(r),l=n(722),s=n(696),c=n.n(s),u=n(698),f=n.n(u),d=n(697),m=n.n(d),p=n(731),h=n(732),y=n(726),b=n(317),w=n(737),g=n(57);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=O(e);if(t){var a=O(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return _(this,n)}}function _(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k={overflow:"auto!important"},P={fontFamily:"Gotham Rounded",fontWeight:"bold",fontStyle:"normal",fontSize:"1.25em"},D={paddingTop:"1em",paddingBottom:"1em"},U={fontSize:"0.75em"},T={backgroundColor:"#C5C8C8",borderColor:"#C5C8C8"},I={backgroundColor:"#007BFF",borderColor:"#007BFF"},A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(i,e);var t,n,o,r=S(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e))._timeout=null,t}return t=i,(n=[{key:"componentDidUpdate",value:function(){var e=this;null!==this.props.queue&&(this._timeout=setTimeout((function(){e._timeout=null,window.open("https://instagram.com/accounts/logout","_blank"),window.location.assign("".concat(g.a.serverURL,"/v/vip/logout"))}),12e4))}},{key:"componentWillUnmount",value:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.queue,o=e.stream,r=e.onLogOut,i=e.onDoVideoCalls;return a.a.createElement("div",{style:k},a.a.createElement(y.a,{expand:"lg",variant:"light",bg:"light",fixed:"top"},a.a.createElement("div",{style:P,className:"m-0 text-secondary"},"THE CHAT MATRIX"),a.a.createElement(b.a,{style:T,variant:"secondary",className:"ml-auto",onClick:r},"Log Out")),a.a.createElement("div",{className:"d-flex flex-column align-items-center text-center py-5 mx-2 mx-md-5"},a.a.createElement("div",{className:"pt-4 my-3"},a.a.createElement("p",{className:"lead m-0"},a.a.createElement("strong",null,"Hi ",t.full_name,"!"))),null==n&&a.a.createElement("div",{className:"my-3"},a.a.createElement("p",{className:"m-0"},a.a.createElement("small",null,'Nobody is waiting to do a video call with you at the moment. When, at least, one person is waiting to do a video call with you, a green "Do Video Calls now" button will appear here.'))),null!==n&&a.a.createElement("div",{className:"mb-3"},a.a.createElement("p",{className:"m-0 pb-1"},a.a.createElement("small",null,"This is how you will look when you do video calls:")),a.a.createElement(w.a,{stream:o}),a.a.createElement(b.a,{style:I,variant:"primary",size:"lg",className:"mt-3",onClick:i},"Do Video Calls now")),a.a.createElement("div",{className:"my-3"},a.a.createElement("p",{className:"m-0"},a.a.createElement("small",null,"Share this ",a.a.createElement("a",{href:"/".concat(t.username)},"link")," on all of your social media now, and then wait here while your fans start queuing up. You might find this ",a.a.createElement("a",{href:"https://www.huffingtonpost.com/2015/02/25/get-instagram-likes_n_6751614.html",target:"_blank",rel:"noopener noreferrer"},"link")," useful."))),a.a.createElement("div",{className:"my-3"},a.a.createElement("p",{className:"m-0"},a.a.createElement("small",null,"The time length of each video call will be 1 second. The name of the person you will do a video call with will appear during the video call. ",a.a.createElement("b",null,'Say "Hi [Name]!"'),'. If you cannot see the person during a video call, still say "Hi [Name]!" because they can still see and hear you. When you press the green "Do Video Calls now" button, up to 10 video calls will happen automatically, one after another. Please use headphones to prevent echoing during video calls. Please take measures to prevent causing harm to your health. You will be automatically logged out if you do not video call the next person within 2 minutes.'))),a.a.createElement("div",{className:"my-3"},a.a.createElement("p",null,a.a.createElement("small",null,"Access information about your earnings ",a.a.createElement("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer"},"here"),". The following ",a.a.createElement("a",{href:"/terms-of-use",target:"_blank"},"Terms of Use"),", ",a.a.createElement("a",{href:"/privacy-policy",target:"_blank"},"Privacy Policy")," and ",a.a.createElement("a",{href:"/vip/terms-and-conditions",target:"_blank"},"Terms & Conditions")," apply to you. Find out what personal data we store about you ",a.a.createElement("a",{href:"/vip/data",target:"_blank"},"here")," (subject access request).")))),a.a.createElement("footer",{style:D,className:"fixed-bottom bg-light text-secondary"},a.a.createElement("div",{style:U,className:"text-center"},"Copyright Â©. All rights reserved.")))}}])&&E(t.prototype,n),o&&E(t,o),i}(a.a.Component);A.propTypes={user:i.a.object,queue:i.a.array,stream:i.a.object,onLogOut:i.a.func,onDoVideoCalls:i.a.func};var R=A,L=n(733),j=n(738),N=n(735),x=n(112),M=n(723),F=n(745),V=n.n(F);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=J(e);if(t){var a=J(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return B(this,n)}}function B(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q={fontFamily:"Gotham Rounded",fontWeight:"bold",fontStyle:"normal",fontSize:"1.25em"},Y={backgroundColor:"#C5C8C8",borderColor:"#C5C8C8"},X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(i,e);var t,n,o,r=G(i);function i(){return W(this,i),r.apply(this,arguments)}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isUserMediaAllowed,n=e.onLogOut;setTimeout((function(){t||n()}),5e3)}},{key:"render",value:function(){var e=this.props,t=e.show,n=e.onLogOut;return a.a.createElement(x.a,{centered:!0,keyboard:!1,backdrop:"static",show:t},a.a.createElement(y.a,{expand:"lg",variant:"light",bg:"light",fixed:"top"},a.a.createElement("div",{style:Q,className:"m-0 text-secondary"},"THE CHAT MATRIX"),a.a.createElement(b.a,{style:Y,variant:"secondary",className:"ml-auto",onClick:n},"Log Out")),a.a.createElement(x.a.Body,{className:"text-justify"},a.a.createElement("p",null,"Please allow camera access and microphone access (by changing your browser settings for this website), then ",a.a.createElement("b",null,"reload")," this page. You can usually give access by first pressing the far left area of your browser's address bar. The area to press is marked red in the picture below."),a.a.createElement(M.a,{fluid:!0,src:V.a,className:"w-100"})))}}])&&q(t.prototype,n),o&&q(t,o),i}(a.a.Component);X.propTypes={show:i.a.bool,onLogOut:i.a.func,isUserMediaAllowed:i.a.bool};var Z=X,K=n(211),$=n(705),ee=n(736),te=n.n(ee);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=se(e);if(t){var a=se(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return ie(this,n)}}function ie(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?le(e):t}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(i,e);var t,n,o,r=re(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),ce(le(t=r.call(this,e)),"handleWindowResize",(function(){t.setState({windowWidth:window.innerWidth,windowHeight:window.innerHeight})})),ce(le(t),"handleLogOut",(function(){window.open("https://instagram.com/accounts/logout","_blank"),window.location.assign("".concat(g.a.serverURL,"/v/vip/logout"))})),ce(le(t),"handleGetUserMedia",(function(e,n){if(n)return console.log(n),void t.setState({isAskForUserMediaAccess:!1,isUserMediaAllowed:!1,stream:null});t.setState({isAskForUserMediaAccess:!1,isUserMediaAllowed:!0,stream:e})})),ce(le(t),"handleFaceFind",(function(e){if(!e)return t.handleLogOut();var n=t.state.user.id+"_"+m.a.generate(16);p.a.upload(e,n).then((function(){return t.setState({avatar:e,avatarID:n})})).then((function(){return t.openSocketConnection()})).catch((function(e){return console.log(e)}))})),ce(le(t),"handleDoVideoCalls",(function(){t.isDoingVideoCalls||(t.isDoingVideoCalls=!0,t.state.io.emit("INITIALIZE_VIP_CHAT"))})),ce(le(t),"handleCallStart",(function(){t.setState({isCallStarted:!0})})),ce(le(t),"handleCallExit",(function(){t.setState({isCallStarted:!1})})),ce(le(t),"handleVIPCallEnd",(function(){t.isDoingVideoCalls=!1,h.a.reset(),t.setState({isCallStarted:!1})})),ce(le(t),"openSocketConnection",(function(){var e=t.state,n=e.isUserMediaAllowed,o=e.user,a=e.userIP,r=e.avatarID;console.log("User ID:",o.id),console.log("User IP:",a);var i=f()(g.a.serverURL);i.once("connect",(function(){t.setState({io:i});var e={userId:o.id,vip:!0,IP:a,username:o.username,fullname:o.full_name,userMediaAllowed:n,avatarId:r,followedBy:o.counts.followed_by,follows:o.counts.follows,profilePicture:o.profile_picture};i.emit("ADD_USER",e)})),i.once("connect_error",(function(e){console.log(e)})),i.once("disconnect",(function(e){console.log(e),"transport close"===e&&t.handleLogOut(),"io server disconnect"===e&&t.props.history.push("/b823a745/e4a6c13b")})),i.once("ADDED",(function(){h.a.onTimeout=function(){t.handleLogOut()},h.a.reset(),i.emit("UPDATE_AVATAR")})),i.on("QUEUE_JOINED",(function(e){h.a.stop(),t.ringtone.play();var n=e.map((function(e){return{userId:e.userId,username:e.username,userfullname:e.fullname}}));t.setState({queue:n})})),i.on("QUEUE_LEFT",(function(e,n){var o=null;t.ringtone.stop(),e.length>0?o=e.map((function(e){return{userId:e.userId,username:e.username}})):t.state.isCallStarted||h.a.reset(),t.setState({queue:o})}))})),t.state={windowWidth:0,windowHeight:0,isUserMediaAllowed:!0,isAskForUserMediaAccess:!1,isCallStarted:!1,user:null,userIP:null,stream:null,avatar:null,avatarID:null,io:null,queue:null,browserDetect:!1,message:null},t.handleConnectionChange=t.handleConnectionChange.bind(le(t)),t.isDoingVideoCalls=!1,t.ringtone=new $.Howl({src:[te.a]}),t}return t=i,(n=[{key:"componentDidMount",value:function(){var e,t=this;window.addEventListener("resize",this.handleWindowResize),c.a.get("".concat(g.a.serverURL,"/v/vip/user")).then((function(t){var n=t.data;if("object"===ne(n))return e=n,c.a.get("".concat(g.a.serverURL,"/c/client/ip"));throw new Error("Invalid Object user")})).then((function(n){t.setState({user:e,userIP:n.data,isAskForUserMediaAccess:!0,windowWidth:window.innerWidth,windowHeight:window.innerHeight})})).catch((function(e){console.log(e),t.props.history.push("/b823a745/e4a6c13b")})),window.addEventListener("offline",this.handleConnectionChange),this.browserDetectHandler()}},{key:"componentWillUnmount",value:function(){h.a.onTimeout=null,h.a.stop();var e=this.state.io;e&&(e.off("QUEUE_JOINED"),e.off("QUEUE_LEFT"),e.close()),window.removeEventListener("resize",this.handleWindowResize)}},{key:"browserDetectHandler",value:function(){var e=a.a.createElement("h5",{className:"mb-0"},"Please use The Chat Matrix in the"," ",a.a.createElement("a",{href:"https://www.google.com/chrome/"},"Google Chrome")," web browser.");this.setState({message:e}),g.a.browserPCDetect&&this.setState({browserDetect:!0})}},{key:"handleConnectionChange",value:function(e){var t=this;"offline"===e.type&&setTimeout((function(){localStorage.setItem("connectChange","offline"),t.props.history.push("/b823a745/e4a6c13b"),t.handleLogOut()}),2e3)}},{key:"render",value:function(){var e=this.state,t=e.windowWidth,n=e.windowHeight,o=e.isUserMediaAllowed,r=e.isAskForUserMediaAccess,i=e.isCallStarted,s=e.user,c=e.userIP,u=e.stream,f=e.avatar,d=e.io,m=e.queue,p=e.browserDetect,h=e.message;if(!o)return a.a.createElement(Z,{show:!0,onLogOut:this.handleLogOut,isUserMediaAllowed:o});var y=null!==s?s.id:null;return a.a.createElement(l.a,{fluid:!0},null!==s&&!1===i&&a.a.createElement(R,{user:s,queue:m,stream:u,onLogOut:this.handleLogOut,onDoVideoCalls:this.handleDoVideoCalls}),a.a.createElement(N.a,{queue:m,isUserVIP:!0,userID:y,userIP:c,io:d,localStream:u,windowWidth:t,windowHeight:n,onStart:this.handleCallStart,onExit:this.handleCallExit,onVIPEnd:this.handleVIPCallEnd}),a.a.createElement(L.a,{isAsk:r,onGetUserMedia:this.handleGetUserMedia}),a.a.createElement(j.a,{avatar:f,stream:u,isVIP:!0,onFind:this.handleFaceFind}),p&&h&&a.a.createElement(K.a,{message:h,resolveLabel:"Log Out",onResolve:this.handleLogOut}))}}])&&oe(t.prototype,n),o&&oe(t,o),i}(o.Component);ue.propTypes={history:i.a.object};t.default=ue}}]);